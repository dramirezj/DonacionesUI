function saveUser(){$("#formNewUser").submit(function(e){e.preventDefault(),departments=$("#departments").val(),photo=$("#photo")[0].files[0],save=$("#save").val();var a=new FormData($("#formNewUser").get(0));a.append("departments",departments),a.append("photo",photo),a.append("save",save),$.ajax({url:"controlador/save.controller.php",method:"POST",datatype:"json",processData:!1,contentType:!1,data:a,success:function(e){"Ok"==e?($("#errores").html(""),Swal.fire({icon:"success",title:"Usuario creado exitosamente!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()})):"Error"==e?Swal.fire({icon:"error",title:"No se pudo crear el usuario!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()}):$("#errores").html(e)},error:function(e){console.log(e)}})})}function editUser(){$("#formEditUser").submit(function(e){e.preventDefault(),formData=new FormData($("#formEditUser").get(0)),departments=$("#departments").val(),save=$("#save").val(),formData.append("departments",departments),formData.append("save",save),$.ajax({url:"http://localhost/LostCallUI/controlador/save.controller.php",method:"POST",datatype:"json",processData:!1,contentType:!1,data:formData,success:function(e){"Ok"==e?Swal.fire({icon:"success",title:"Usuario actualizado exitosamente!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){pathname=window.location.pathname,window.location.href=window.location.origin+"/"+pathname.split("/")[1]+"/listar-usuarios"}):"Error"==e&&Swal.fire({icon:"error",title:"No se pudo actualiado el usuario!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()})},error:function(e){console.log(e)}})})}function editDeparment(){$("#formEditDepartment").submit(function(e){e.preventDefault(),formData=new FormData($("#formEditDepartment").get(0)),save=$("#save").val(),formData.append("save",save),$.ajax({url:"http://localhost/LostCallUI/controlador/save.controller.php",method:"POST",datatype:"json",processData:!1,contentType:!1,data:formData,success:function(e){console.log(e),"Ok"==e?Swal.fire({icon:"success",title:"Departamento actualizado exitosamente!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){pathname=window.location.pathname,window.location.href=window.location.origin+"/"+pathname.split("/")[1]+"/listar-departamentos"}):"Error"==e&&Swal.fire({icon:"error",title:"No se pudo actualiado el departamento!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()})},error:function(e){console.log(e)}})})}function deleteDeparment(e){$.ajax({url:"http://localhost/LostCallUI/controlador/delete.controller.php",method:"POST",data:{id:e,accion:"eliminarDepartamento"},success:function(e){console.log(e),"Ok"==e?Swal.fire({icon:"success",title:"Departamento eliminado exitosamente!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()}):"Error"==e&&Swal.fire({icon:"error",title:"No se pudo eliminar el departamento!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()})}})}function deleteUser(e){$.ajax({url:"http://localhost/LostCallUI/controlador/delete.controller.php",method:"POST",data:{id:e,accion:"eliminarUsuario"},success:function(e){console.log(e),"Ok"==e?Swal.fire({icon:"success",title:"Usuario eliminado exitosamente!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()}):"Error"==e&&Swal.fire({icon:"error",title:"No se pudo eliminar el usuario!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()})}})}function saveCall(){$("#formSaveCall").submit(function(e){e.preventDefault(),formData=new FormData($("#formSaveCall").get(0)),save=$("#save").val(),formData.append("save",save),$.ajax({url:"controlador/save.controller.php",method:"POST",datatype:"json",processData:!1,contentType:!1,data:formData,success:function(e){"Ok"==e?Swal.fire({icon:"success",title:"Llamada registrada correctamente!",backdrop:!1,position:"center",allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()}):"Error"==e&&Swal.fire({icon:"success",title:"No se pudo registrar la llamada!",backdrop:!1,position:"center",allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()})},error:function(e){console.log(e)}})})}function saveEnterprise(){$("#formNewEnterprise").submit(function(e){e.preventDefault(),logo=$("#logo")[0].files[0],save=$("#save").val();var a=new FormData($("#formNewEnterprise").get(0));a.append("logo",logo),a.append("save",save),$.ajax({url:"controlador/save.controller.php",method:"POST",datatype:"json",processData:!1,contentType:!1,data:a,success:function(e){"Ok"==e?Swal.fire({icon:"success",title:"Empresa creada exitosamente!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()}):"Error"==e&&Swal.fire({icon:"error",title:"No se pudo crear la empresa!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()})},error:function(e){console.log(e)}})})}function saveDepartment(){$("#formNewDepartment").submit(function(e){e.preventDefault(),name=$("#name").val(),enabled=$("#enabled").val(),save=$("#save").val(),$.ajax({url:"controlador/save.controller.php",method:"POST",datatype:"json",data:{name:name,enabled:enabled,save:save},success:function(e){"Ok"==e?Swal.fire({icon:"success",title:"Departamento creado exitosamente!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()}):"Error"==e&&Swal.fire({icon:"error",title:"No se pudo crear el departamento!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()})},error:function(e){console.log(e)}})})}function saveUserEnterprise(){$("#formNewUserEnterprise").submit(function(e){e.preventDefault(),firstname=$("#firstname").val(),lastname=$("#lastname").val(),email=$("#email").val(),password=$("#password").val(),enterprise_id=$("#enterprise_id").val(),extension=$("#extension").val(),role_id=$("#rol").val(),enabled=$("#enabled").val(),save=$("#save").val(),$.ajax({url:"controlador/save.controller.php",method:"POST",datatype:"json",data:{email:email,password:password,firstname:firstname,lastname:lastname,enterprise_id:enterprise_id,extension:extension,role_id:role_id,enabled:enabled,save:save},success:function(e){null!=e?Swal.fire({icon:"success",title:"Usuario creado exitosamente!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()}):Swal.fire({icon:"error",title:"No se pudo crear el usuario!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){$window.location.reload()})},error:function(e){console.log(e)}})})}function passwordChange(){$("#formPasswordChange").submit(function(e){e.preventDefault(),password=$("#password").val(),confirmation=$("#confirmation").val(),save=$("#save").val(),$.ajax({url:"controlador/save.controller.php",method:"POST",datatype:"json",data:{password:password,confirmation:confirmation,save:save},success:function(e){"Ok"==e?($("#errores").html(""),Swal.fire({icon:"success",title:"Contraseña se ha cambiado con éxtito!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.href="salir"})):"Error"==e?Swal.fire({icon:"error",title:"Error al cambiar la contraseña!",backdrop:!0,position:"center",allowOutsideClick:!0,allowEscapeKey:!1,allowEnterKey:!1}).then(function(){window.location.reload()}):$("#errores").html(e)},error:function(e){console.log(e)}})})}function reporteLlamadas(){$("#accion").click(function(e){e.preventDefault(),fechaInicio=$("#fechaInicio").val(),fechaFinal=$("#fechaFinal").val(),department=$("#department").val(),status=$("#status").val(),page=getParameterByName("page"),$.ajax({url:"controlador/generarreporte.controller.php?page="+page,method:"POST",datatype:"json",data:{fechaInicio:fechaInicio,fechaFinal:fechaFinal,department:department,status:status,accion:"filtrar"},success:function(e){$("#resultados").html(e)}})})}function reporteLlamadas(e){fechaInicio=$("#fechaInicio").val(),fechaFinal=$("#fechaFinal").val(),department=$("#department").val(),status=$("#status").val(),0==department.length&&(department="NULL"),$.ajax({url:"controlador/generarreporte.controller.php?page="+e,method:"POST",datatype:"json",data:{fechaInicio:fechaInicio,fechaFinal:fechaFinal,department:department,status:status,accion:"filtrar"},success:function(e){$("#resultados").html(e)}})}function exportarCSV(){fechaInicio=$("#fechaInicio").val(),fechaFinal=$("#fechaFinal").val(),department=$("#department").val(),status=$("#status").val(),$.ajax({url:"controlador/exportar.controller.php",method:"POST",datatype:"json",data:{fechaInicio:fechaInicio,fechaFinal:fechaFinal,department:department,status:status,accion:"exportar"},success:function(e){var a=document.createElement("a"),o=new Blob(["\ufeff"+e],{type:"text/csv;charset=utf-8;"}),t=URL.createObjectURL(o);a.href=t,a.download="lost_call.csv",document.body.appendChild(a),a.click(),document.body.removeChild(a)}})}function exportarXLS(){fechaInicio=$("#fechaInicio").val(),fechaFinal=$("#fechaFinal").val(),department=$("#department").val(),status=$("#status").val(),$.ajax({url:"controlador/exportar.controller.php",method:"POST",datatype:"json",data:{fechaInicio:fechaInicio,fechaFinal:fechaFinal,department:department,status:status,accion:"exportarXLS"},success:function(e){}})}function getParameterByName(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))}$(document).ready(function(){saveUser(),editUser(),saveDepartment(),editDeparment(),saveEnterprise(),saveUserEnterprise(),saveCall(),passwordChange()});